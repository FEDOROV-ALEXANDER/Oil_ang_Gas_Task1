

## Решение задачи пьезопроводности в плоской постановке с неоднородностью в проницаемости

### Описание задачи

В данной программе решается задача пьезопроводности в плоской постановке с учетом неоднородности в проницаемости пласта. Задача формулируется следующим образом:

#### Уравнение пьезопроводности

Уравнение пьезопроводности в двумерной постановке имеет вид:

!https://latex.codecogs.com/svg.latex?%5Cfrac%7B%5Cpartial%20p%7D%7B%5Cpartial%20t%7D%20%3D%20%5Ceta%20%5Cleft(%20%5Cfrac%7B%5Cpartial%5E2%20p%7D%7B%5Cpartial%20x%5E2%7D%20%2B%20%5Cfrac%7B%5Cpartial%5E2%20p%7D%7B%5Cpartial%20y%5E2%7D%20%5Cright)

где:
- $ p $ - давление в пласте,
- $ t $ - время,
- $ x, y $ - пространственные координаты,
- $ \eta = \frac{k}{\phi \mu c} $ - коэффициент пьезопроводности,
- $ k $ - проницаемость,
- $ \phi $ - пористость,
- $ \mu $ - вязкость флюида,
- $ c $ - сжимаемость.

#### Граничные условия

1. **На бесконечности**:
   
   $\lim_{x, y \to \infty} p(x, y, t) = 0$
   

2. **На скважинах**:
   На каждой скважине задается постоянный дебит $ q $. Граничное условие на скважине можно записать как:
   $(r \left. \frac{\partial{p}}{\partial{r}}) \right |_{r = r_w} = - \frac{qB\mu}{2\pi k h}$
   где:
   - $ B $ - объемный коэффициент,
   - $ h $ - толщина пласта,
   - $ r_w $ - радиус скважины.

#### Начальные условия

Начальное распределение давления в пласте:
$
p(x, y, 0) = p_0, 
$
где $ p_0 $ - начальное давление в пласте.

### Схема расчета

Для решения задачи используется явный метод конечных разностей. Схема расчета выглядит следующим образом:

1. **Дискретизация уравнения**:
   $
   \frac{p_{i,j}^{n+1} - p_{i,j}^n}{\Delta t} = \eta_{i,j} \left( \frac{p_{i+1,j}^n - 2p_{i,j}^n + p_{i-1,j}^n}{\Delta x^2} + \frac{p_{i,j+1}^n - 2p_{i,j}^n + p_{i,j-1}^n}{\Delta y^2} \right)
   $
   где:
   - $ p_{i,j}^n $ - значение давления в узле $ (i, j) $ в момент времени $ n $,
   - $ \Delta t $ - шаг по времени,
   - $ \Delta x, \Delta y $ - шаги по пространству.

2. **Обновление давления**:
   $
   p_{i,j}^{n+1} = p_{i,j}^n + \eta_{i,j} \Delta t \left( \frac{p_{i+1,j}^n - 2p_{i,j}^n + p_{i-1,j}^n}{\Delta x^2} + \frac{p_{i,j+1}^n - 2p_{i,j}^n + p_{i,j-1}^n}{\Delta y^2} \right)
   $



### Обзор программы

Программа состоит из нескольких модулей:

- **main.py**: Основной скрипт, который инициализирует параметры модели, задает начальные и граничные условия, а также запускает расчет.
- **Solve.py**: Содержит функцию `solve_for_one_well_explicit`, которая реализует явный метод конечных разностей для решения уравнения пьезопроводности для одной скважины.
- **well.py**: Определяет класс `Well`, который представляет скважину с заданными параметрами (координаты, радиус, дебит и т.д.).
- **Results.py**: Содержит функции для визуализации результатов расчета (распределение давления, проницаемости, продуктивности скважин и т.д.) и их сохранения.

### Пример использования

В программе заданы следующие параметры:

- **Геометрические размеры рассчитываемой области**: 2500x2500 м.
- **Количество скважин**: 4.
- **Дебиты скважин**: 800, 1000, -700, -800 м³/сут.
- **Проницаемость**: 100 * 10⁻¹⁶ м² (с неоднородностью).
- **Вязкость**: 10 * 10⁻⁷ Па·с.
- **Сжимаемость**: 5 * 10⁻⁵ 1/Па.
- **Пористость**: 0.05.
- **Объемный коэффициент**: 1.2.
- **Толщина пласта**: 10 м.
- **Время работы**: 5 лет (365 * 5 дней).

### Результаты

Результаты расчета сохраняются в файлы Excel и изображения:

- **history_field_pressure.xlsx**: Содержит историю изменения давления в каждой точке расчетной области.
- **well_information.xlsx**: Содержит информацию о давлении на забоях скважин и их продуктивности.
- **проницаемость.png**: Визуализация распределения проницаемости.
- **результат_давление.png**: Визуализация распределения давления в пласте.
- **давление_забой.png**: Изменение давления на забоях скважин во времени.
- **продуктивность.png**: Продуктивность добывающих скважин.

### Примеры изображений

Здесь можно добавить примеры изображений, полученных в результате работы программы.
![проницаемость.png](%D0%9D%D0%B5%D1%84%D1%82%D0%B5%D0%B3%D0%B0%D0%B7%20%D0%A0%D0%B5%D1%81%D1%87%D0%B5%D1%82%D0%BA%D0%B0%2Fresults%20files%2F%D0%BF%D1%80%D0%BE%D0%BD%D0%B8%D1%86%D0%B0%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D1%8C.png)
![результат_давление.png](%D0%9D%D0%B5%D1%84%D1%82%D0%B5%D0%B3%D0%B0%D0%B7%20%D0%A0%D0%B5%D1%81%D1%87%D0%B5%D1%82%D0%BA%D0%B0%2Fresults%20files%2F%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82_%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5.png)
![давление_забой.png](%D0%9D%D0%B5%D1%84%D1%82%D0%B5%D0%B3%D0%B0%D0%B7%20%D0%A0%D0%B5%D1%81%D1%87%D0%B5%D1%82%D0%BA%D0%B0%2Fresults%20files%2F%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D0%B1%D0%BE%D0%B9.png)
![продуктивность.png](%D0%9D%D0%B5%D1%84%D1%82%D0%B5%D0%B3%D0%B0%D0%B7%20%D0%A0%D0%B5%D1%81%D1%87%D0%B5%D1%82%D0%BA%D0%B0%2Fresults%20files%2F%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D1%81%D1%82%D1%8C.png)
---

**Примечание**: Для корректной работы программы убедитесь, что все необходимые библиотеки установлены. Для установки зависимостей можно использовать команду:

```bash
pip install numpy pandas matplotlib 
```
